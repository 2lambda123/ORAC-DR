# _DIVIDE_BY_FLAT_         -*- perl -*-
#
# Divides by a flat-field. 
#
# TASK: CCDPACK - FLATCOR
#
# This should only be performed on OBJECT frames.
    if ($Frm->hdr(OBSTYPE) =~ /OBJECT/ || $Frm->hdr(OBSTYPE) =~ /SKY/) {

# Generate list of input and output filenames.
       ($in, $out) = $Frm->inout("_ff");

# Set the parameters for the task.
       $header = "in=$in flat=".$Cal->flat." out=$out title=\'Flat-fielded\'";

# Flatfield the object frame.
       $Mon{"ccdpack_red"}->obeyw("flatcor","$header");

# Report the processing status.
       orac_print "Orac says: frame $in flat-fielded made $out\n";

# Now update the output filename in the Frame object.
       $Frm->file($out);

# Display the image.
       _DISPLAY_FRAME_IMAGE_

    };
