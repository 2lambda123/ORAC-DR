# _MASK_DEVIANTS_          -*-perl-*-
#
# Masks pixels which are deviant from the neighbourhood.
#
# TASK: KAPPA - FFCLEAN
#

#  Specify the parameters.
    my $hidden = "clip=[3,3,3] title=\'Deviant pixels masked\'";
    my $boxsize = ( $_MASK_DEVIANTS_{BOXSIZE} || 15 );
    my $user = "box=$boxsize";

# Generate the input and output filenames.
    ( my $in, my $out ) = $Frm->inout( "_md" );

# Debias the frame using a 0 bias contribution.  There is no bad-pixel
# masking.  Do not create a variance array.
    $Mon{"kappa_mon"}->obeyw("ffclean","in=$in out=$out $hidden $user");

# Report the processing.
    orac_print "Orac says: $in to $out: Deviant pixels masked\n";

# Record the new file name in the frame object.
    $Frm->file( $out );                      # obligatory update step

# Display the image.
    _DISPLAY_FRAME_IMAGE_
