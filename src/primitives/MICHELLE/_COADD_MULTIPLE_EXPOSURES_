# _COADD_MULTIPLE_EXPOSURES_
#
# Primitive to coadd exposures at the same grating position
#
# This should eventually differentiate between multiple frames at
# different positions and chop beams etc.  and could possibly have
# multi frame outputs. In other words, this primitive is going to get
# a lot more complicated than this.

# frossie@jach.hawaii.edu


# generate "ia + ib + ic .... " expression for kappa maths
my $exp = join ("+",grep {$_ = "i".chr($_+96)} (1..$Frm->nfiles));

# generate "ia=cfoo_1.i1  ib=cfoo_1.i2 ic=cfoo_1.i3 .... " expression for input to kappa maths
my $args =  join (" ",grep {$_ = "i".chr($_+96)."=".$Frm->file($_)} (1..$Frm->nfiles));

# generate name of output file
$Frm->files($Frm->file);
($in,$out) = $Frm->inout("_co");

$Mon{'kappa_mon'}->obeyw("maths","exp=$exp out=$out $args");

$Frm->file($out);

$Display->display_data($Frm);

orac_print ("Frames coadded into $out\n");
