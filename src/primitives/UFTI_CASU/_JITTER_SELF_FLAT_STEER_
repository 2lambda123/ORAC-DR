    # Number of offsets in the jitter pattern

    my $number = $Frm->uhdr("ORAC_NUMBER_OF_OFFSETS") - 1;

    # Ok, several jitter patterns can be in the same group.  Flag
    # to do flat combination and dither when we've got a complete
    # jitter pattern.  Store away the first run in the jitter so that
    # you can use it to name the output files in the event that the group 
    # number may covers more than one jitter pattern)

    if (($Grp->num + 1) % $number == 0) {
        $Frm->uhdr("GOT_EM_ALL",1);
    } else {
        $Frm->uhdr("GOT_EM_ALL",0);
    }
    if (($Grp->num + 1) % $number == 1) {
        $Frm->uhdr("REF_RUNNO",1);
    } else {
        $Frm->uhdr("REF_RUNNO",0);
    }
    $Frm->uhdr("CYCLE_NUMBER",int(($Grp->num)/$number));

