# -*-perl-*-

=head1 NAME

_TAG_AS_REDUCED_PRODUCT_GROUP_ -- Tag current group files as "reduced".

=head1 DESCRIPTION

Tag all members of the SCUBA group as "reduced".

=head1 OUTPUT DATA

=over 4

=item *

Products with suffix _reduced.

=back

=head1 AUTHORS

Tim Jenness E<lt>t.jenness@jach.hawaii.eduE<gt>

=head1 COPYRIGHT

Copyright (C) 2009 Science and Technology Facilities Council. All
Rights Reserved.

=cut

my $inroot = $Grp->file;

# Need to hack a mini inout method
my ($junk, $suffix) = $Grp->_split_fname( $inroot );
pop(@$junk); # remove last entry
push(@$junk, "reduced");
my $outroot = $Grp->_join_fname( $junk, $suffix );

# derive each file name
for my $sub ($Frm->subs) {

    # current filename
    my $in = $Grp->grpoutsub( $sub );

    # No inout method
    $Grp->file( $outroot );
    my $out = $Grp->grpoutsub( $sub );
    $Grp->file( $inroot );

    $Mon{'ndfpack_mon'}->obeyw( "ndfcopy", "in=$in out=$out" );

    orac_print "$in to $out:\n Tagged as reduced product.\n";

    $Grp->allow_header_sync(1);
    $Grp->product( "reduced" );
    $Grp->sync_headers($out);
}

$Grp->file( $outroot );
