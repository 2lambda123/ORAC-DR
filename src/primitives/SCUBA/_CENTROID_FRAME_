=head1 NAME

CENTROID_FRAME

=head1 DESCRIPTION

Find the centroid(s) of the current frame(s).
Assumes that the centroid is near the origin in axis
coordinates. Errors will be reported.

=head1 TASKS

Uses the KAPPA CENTROID task.

=head1 ARGUMENTS

  BOX = Size of search box in each dimension.
        Default is 9 pixels.

=head1 NOTE

KLUGE ALERT!!!!!!!!!!!!!!!!!!!!1

THIS PRIMITIVE ASSUMES THAT IT IS RUN AFTER _REBIN_FRAME_
(since centroid is meaningless without an image) AND
THAT _REBIN_FRAME_ USED A SUFFIX OF '_reb' (since REBIN_FRAME
does not update the Frame object).

It may be necessary to merge this with a new REBIN_FRAME....

=cut


$box = ( $_CENTROID_FRAME_{BOX} || 9 );


foreach my $i (1..$Frm->nfiles) {
  
  my ($in, $out) = $Frm->inout('_reb',$i);

  my $args = " cosys=d mode=i cerror=true search=$box";

  $Mon{kappa_mon}->obeyw("centroid","ndf=$out init=[0,0] $args");

  # Read the result
  ($ORAC_STATUS, @centre) = $Mon{kappa_mon}->get("centroid","centre");
 
  orac_print "Centroid position: $centre[0], $centre[1]\n";

}
