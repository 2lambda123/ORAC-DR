=head1 NAME

REMOVE_SCAN_BASELINE

=head1 DESCRIPTION

Remove the base level from each scan.

=head1 TASKS

SURF: SCAN_RLB

=head1 OPTIONS

The baseline removal method (METHOD) can be either median or linear.If
METHOD=linear an additional parameter is required that governs the
size of the linear region (SIZE). Alternatively, it is possible to
specify exposure (scan) numbers as a comma separated list (METHOD=exp
EXP=1,2,5). It it not yet possible to select the last scan without
knowing which scan it is. Default scan is 1.

Defaults is METHOD=MEDIAN and SIZE=100 (arcsec).


=cut

# Read the input arguments
my $method = ($_REMOVE_SCAN_BASELINE_{METHOD} || 'median');
my $size = ($_REMOVE_SCAN_BASELINE_{SIZE} || 100.0);
my $exp  = ($_REMOVE_SCAN_BASELINE_{EXP} || 1 );

# if method is EXP translate that to SECTION
if ($method =~ /^exp/i) {
  $method = 'SECTION';

  # include the exposure list
  $method .= " section='{e$exp}'";

}

my $nfiles = $Frm->nfiles;
for my $i (1..$nfiles) {

  my ($in, $out) = $Frm->inout('_rlb', $i);

  # Run scan_rlb
  my $args = "method=$method chop=$size rlb=true";
  $Mon{surf_mon}->obeyw("scan_rlb", "in=$in out=$out $args");
 
  # Update filename
  $Frm->file($i, $out);

}

orac_print "Subtracting baselines with method $method\n";


# COPYRIGHT
#
#   Copyright (C) 1998-2000 Particle Physics and Astronomy Research
#   Council. All Rights Reserved.


