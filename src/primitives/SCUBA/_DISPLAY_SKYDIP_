=head1 NAME

DISPLAY_SKYDIP

=head1 DESCRIPTION

Display the skydip data and fit for each sub-instrument.
Similar to SURF SDIP.

Currently do not display anything for a sub-instrument
if the fit failed. This may not be the best thing
to do -- in some cases the data may be useful to see
even if the fit fails.

=head1 TASKS

Kappa: LINPLOT

=cut

# Check that we are actually processing a Skydip
if ($Frm->hdr('MODE') eq 'SKYDIP') {

  # Counter for XW devices
  $count = 0;

  # List of sub-instruments
  @subs = $Frm->subs;

  # Loop over sub-instruments
  for ($i = 0; $i < $Frm->nsubs; $i++) {

    # Sub inst
    $sub = $subs[$i];

    # Get the input filename
    $in = $Frm->file($i+1);

    # Check that $in is defined (would not be if we
    # failed to fit)
    if ($in =~ /./) {

      # Determine device name
      $count++;
      $device = ( $count == 1 ? "xw" : "x${count}w");

      # Reset the colour palette in the GKS widget
      $Mon{kapview_mon}->obeyw("paldef", "device=$device");

      
      # Plot the data
      $args = "clear axlim=false cosys=data mode=2 pltitl='Skydip: $sub' symcol=white device=$device ordlab='Jsky / K'";

      $Mon{kapview_mon}->obeyw("linplot","ndf=$in $args");

      # Plot the model
      $args = "mode=line device=$device lincol=red pltitl='' noclear ordlab=''";
      $mod_in = $in . '_model';
      $Mon{kapview_mon}->obeyw("linplot","ndf=$mod_in $args");

    }

  }

}
