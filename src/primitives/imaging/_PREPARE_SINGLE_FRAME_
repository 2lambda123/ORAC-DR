#+
# Name:
#    _PREPARE_SINGLE_FRAME_
#
# Purpose:
#    Performs preparatory data-reduction tasks for imaging instruments.
#
# Language:
#    Perl5
#
# Description:
#    This primitive does the preparatory work for recipes used by UFTI,
#    IRCAM, or Michelle in imaging mode.  It can create a variance array
#    using the readout noise, remove a bias frame or null bias, add
#    photon noise to the variance, difference chopped beams, and create
#    a valid WCS.  What is actually performed depends on steering
#    headers.
#
# Notes:
#    -  The functions are performed by other primitives:
#    _ADD_READNOISE_VARIANCE_, _REMOVE_BIAS_, _ADD_POISSON_VARIANCE_,
#    _DIFFERENCE_CHOP_BEAMS_, and _CREATE_WCS_.
#
# Output Data:
#    -  See the primitives mentioned in the Notes.
#
# Authors:
#    MJC: Malcolm J. Currie (JAC)
#
# Copyright:
#    Copyright (C) 1998-2001 Particle Physics and Astronomy Research
#    Council.  All Rights Reserved.
#
#-

# Create a variance array with the readout noise.
    _ADD_READNOISE_VARIANCE_

# This only removes a bias for chopped data.  For normal data, a
# zero-bias is subtracted; the purpose is to make CCDPACK think a
# bias has been removed.
    _REMOVE_BIAS_

# Add photon noise to the earlier variance.
    _ADD_POISSON_VARIANCE_

# Difference the two chop beams.
    _DIFFERENCE_CHOP_BEAMS_

# Create the WCS, if needed.
    _CREATE_WCS_

# Podule
# ======

=head1 NAME

_PREPARE_SINGLE_FRAME_ -- Performs preparatory data-reduction tasks for imaging instruments.

=head1 DESCRIPTION

This primitive does the preparatory work for recipes used by UFTI,
IRCAM, or Michelle in imaging mode.  It can create a variance array
using the readout noise, remove a bias frame or null bias, add
photon noise to the variance, difference chopped beams, and create
a valid WCS.  What is actually performed depends on steering
headers.

=head1 NOTES

The functions are performed by other primitives:
L<_ADD_READNOISE_VARIANCE_|_ADD_READNOISE_VARIANCE>,
L<_REMOVE_BIAS_|_REMOVE_BIAS_>,
L<_ADD_POISSON_VARIANCE_|_ADD_POISSON_VARIANCE_>,
L<_DIFFERENCE_CHOP_BEAMS_|_DIFFERENCE_CHOP_BEAMS>, and
L<_CREATE_WCS_|_CREATE_WCS_>.

=head1 OUTPUT DATA

See the primitives mentioned in the Notes.

=head1 AUTHORS

MJC: Malcolm J. Currie (JAC)

=head1 COPYRIGHT

Copyright (C) 1998-2001 Particle Physics and Astronomy Research
Council.  All Rights Reserved.

=cut
