# -*- perl -*-

=head1 NAME

_TAG_AS_REPRESENTATIVE_IMAGE_  -- Tag image as representative

=head1 DESCRIPTION

For the relevant file, copy it to a new name with product "rimg" and
suffix "_rimg".

=head1 ARGUMENTS

=over 4

=item FILE = STRING (Given)

By default the first file in the frame is tagged as a representative
image. This argument allows an explicit file to be tagged.

=item GROUP = LOGICAL (Given)

Whether to operate on the current Frame or Group object. Defaults to
Frame. [0]

=item UPDATE = LOGICAL (Given)

If true, the output file is stored in the current frame (index 1) and tagged
as product "rimg". Default is for the file not to be put in the frame.

=back

=head1 OUTPUT DATA

=over 4

=item *

An image with suffix _rimg.

=back

=head1 AUTHORS

Brad Cavanagh E<lt>b.cavanagh@jach.hawaii.eduE<gt>

=head1 COPYRIGHT

Copyright (C) 2008 Science and Technology Facilities Council.  All
Rights Reserved.

=cut

my $file = $_TAG_AS_REPRESENTATIVE_IMAGE_{FILE};
my $update = ( $_TAG_AS_REPRESENTATIVE_IMAGE_{UPDATE} ? 1 : 0 );
my $group = ( $_TAG_AS_REPRESENTATIVE_IMAGE_{GROUP} ? 1 : 0 );

my $in = $file;
my $out;
if( ! defined( $file ) ) {
  ( $in, $out ) = $Frm->inout( "_rimg" );
} else {
  ( undef, $out ) = $Frm->inout( "_rimg" );
}

$Mon{'ndfpack_mon'}->obeyw( "ndfcopy", "in=$in out=$out" );

orac_print "$in to $out:\n Tagged as representative image.\n";

_SET_FILE_FITS_ITEM_ FILE=$out KEY=PRODUCT VALUE=rimg

_DISPLAY_FILE_ FILE=$out GROUP=$group

if( $update ) {
  $Frm->product( "rimg" );
  $Frm->file( $out );
}

