# _SUBTRACT_BIAS_          -*- perl -*-
#


# skip if actually a BIAS

unless ($Frm->hdr->{OBSTYPE} eq 'BIAS') {
  
  if ($Frm->hdr->{MODE} ne 'ND_STARE') {
    
    my $bias =  $Cal->bias;
    orac_print "\nOrac says: Bias frame $bias will be used\n";
    
    foreach my $i (1..$Frm->nfiles) {
      
      my $frame = $Frm->file($i);
      # Generate the input and output filenames.
      my ($in,$out) = $Frm->inout("_db",$i);
      
      # Add the mask which comprises bad pixels and zero elsewhere.
      $Mon{"kappa_mon"}->obeyw("sub","in1=$in out=$out in2=$bias title=$out");
      
      # Report the processing status.
      orac_print "Orac says: $in to $out: Bias subtracted\n";
      
      # Record the new file name in the frame object.
      $Frm->file($i,$out);		# obligatory update step
      
    };
    
    
  } else {
    
    orac_print "ND_STARE observation, no bias subtracted\n";

}


}
