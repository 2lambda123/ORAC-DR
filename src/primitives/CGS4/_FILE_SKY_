=head1 NAME                                     -*-perl-*-

FILE_SKY

=head1 DESCRIPTION

File an observation as the current sky.

=cut

if ($Frm->nfiles == 1) {
  
  unless ($Frm->hdr->{'OBSTYPE'} eq 'SKY') {
    orac_warn("This is not a sky frame! Are you running the wrong recipe?\n");
    orac_warn("I'll assume you know what you're doing!\n");
  };

  # Obtain the current frame's number.
  my $obsnum = $Frm->hdr( "OBSNUM" );
  
  # Take a copy of the current frame using a more-identifiable name.
  my $in = $Frm->file;
  my $sky = "sky_" . $obsnum;
  $Mon{ "ndfpack_mon" }->obeyw( "ndfcopy", "in=$in out=$sky" );
  
  # Store the sky as the current frame.
  $Frm->file( $sky );
  
  # File the current frame as the current sky.
  $Cal->sky( $Frm->file );
  
  # Report the processing status.
  orac_print $Frm->file . " filed as the current sky\n";
  
  # Add this frame to the index of sky frames.
  $Cal->skyindex->add( $Frm->file, $Frm->hdr );
  
  # Report the processing status.
  orac_print $Frm->file . " added to index file\n";
  
} else {
  
  orac_warn("Sky frame has not been coadded! Not filed as calibration\n");


}
