=head1 NAME

_PAIR_REDUCTION_STEER_ - steering file for pair-based recipes

=head1 DESCRIPTION

This primitive controls the overall state of a recipe involving
pair subtraction. It currently determines whether we are
an OBJECT or a SKY and whether we are the first or second observation
of a pair. This information is required by many of the group primitives
to determine whether or not to act.

=head1 NOTES

Stores information in the user header of the current frame
with the following keys:

=over 4

=item PAIR_COMPLETE

True if the frame is the second of a pair. False otherwise.

=item ON_SOURCE

True if we are on the object. False if we are on sky.

=back

=head1 NOTES

Incompatible with -batch option in ORAC-DR.

=head1 AUTHOR

Tim Jenness

=cut


# Retrieve the number of frames currently in the group
# Assumes no batch mode

my $num = $Grp->num() + 1;
if ($num % 2 == 1 ) {

  $Frm->uhdr("PAIR_COMPLETE", 0);
  orac_print "This observation is the start of a pair";

} else {
  
  $Frm->uhdr("PAIR_COMPLETE", 1);
  orac_print "This observation completes a pair";

}


# Now calculate whether we are an object or a sky observation

my $raoff = $Frm->hdr("RAOFF");
my $decoff= $Frm->hdr("DECOFF");

# Assume that 0,0 is okay and don't need 
if(($raoff == 0) && ($decoff == 0)) {

  $Frm->uhdr("ON_SOURCE", 1);
  orac_print " and is an OBJECT frame\n";

} else {
  
  $Frm->uhdr("ON_SOURCE", 0);
  orac_print " and is a SKY frame\n";
}
