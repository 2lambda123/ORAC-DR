=head1 NAME

_CONTROL_CGS4DR_ - send a REDUCE command to CGS4DR

=head1 DESCRIPTION

Command CGS4DR/QMAN to reduce the current data. This should be
called after the _EXPORT_CGS4DR_FORMAT_ primitive.

=head1 NOTES

=over 4

=item *

Creates a new object in C<%Mon> which is attached to a
QMAN monolith. This will fail if QMAN is not running.

=item *

CGS4DR must already be running on the same machine as ORAC-DR.

=back

=cut


# Connect to the monolith
$Mon{QMAN} = new Starlink::AMS::Task("qman")
  unless exists $Mon{QMAN};


# Get the observation number [see also _EXPORT_CGS4DR_FORMAT_
# since that uses exactly the same technique
my $num = $Frm->number;
my $ut  = $Frm->hdr('ORACUT');
my $out = substr($ut, 2) . '_' . $nun;

# Send the command
$Mon{QMAN}->obeyw("QMAN","write=\"REDUCE O$out\" qposition=oldest");


