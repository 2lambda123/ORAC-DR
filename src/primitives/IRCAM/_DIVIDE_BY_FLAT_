# _DIVIDE_BY_FLAT_         -*- perl -*-
#
# Divides by a flat-field. 
#
# TASK: CCDPACK - FLATCOR
#
# This should only be performed on OBJECT frames.
    if ( $Frm->hdr( "OBSTYPE" ) eq "OBJECT" ||
         $Frm->hdr( "OBSTYPE" ) eq "SKY") {

# Generate list of input and output filenames.
       ( my $in, my $out ) = $Frm->inout( "_ff" );

# Set the parameters for the task.
       my $header = "in=$in flat=".$Cal->flat." out=$out title=!";

# Flatfield the object frame.
       $Mon{"ccdpack_red"}->obeyw("flatcor","$header");

# Report the processing status.
       orac_print "Orac says: frame $in flat-fielded made $out\n";

# Now update the output filename in the Frame object.
       $Frm->file( $out );

# Display the image.
       _DISPLAY_FRAME_IMAGE_

    }
