# Generate root name.
      $ndf = substr( $Frm->file, 0, 15 );

# Removed intermediate files.
      unlink ( $ndf . "_nm.sdf" );
      unlink ( $ndf . "_md.sdf" );
      unlink ( $ndf . "_db.sdf" );
      unlink ( $ndf . "_bp.sdf" );

# Certain files can only be removed once certain steps are complete,
# and then only as a group.  So determine if it's time to remove these
# files and the cycle number.
      $madeflat = $Frm->hdr( "MAKE_FLAT" );
      $mademosaic = $Frm->hdr( "MAKE_MOSAIC" ); 
      $cycleno = $Frm->hdr( "CYCLE_NUMBER" ); 

# Remove the remaining files from this cycle used to make the flat.
      if ( $madeflat ) {
         $mosgrp = $Grp->subgrp( CYCLE_NUMBER => $cycleno );
         $mosgrp->template( $ndf . "_qm" );
         @ndfnames = $mosgrp->membernames;
         foreach $file ( @ndfnames ) {
            unlink( $file . ".sdf" );
         }
         $mosgrp->template( $ndf . "_dk" );
         @ndfnames = $mosgrp->membernames;
         foreach $file ( @ndfnames ) {
            unlink( $file . ".sdf" );
         }
      }

# Remove the remaining files from this cycle used to make the mosaic.
      if ( $mademosaic ) {
         $mosgrp = $Grp->subgrp( CYCLE_NUMBER => $cycleno );
         $mosgrp->template( $ndf . "_trn" );
         @ndfnames = $mosgrp->membernames;
         foreach $file ( @ndfnames ) {
            unlink( $file . ".sdf" );
         }
      }
