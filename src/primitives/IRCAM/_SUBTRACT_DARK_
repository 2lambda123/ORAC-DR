# _SUBTRACT_DARK_
#
# Subtracts a bias frame
#
# TASK: CCDPACK - CALCOR
#
# This should only be performed on OBJECT frames.
if ($Frm->hdr(OBSTYPE) =~ /OBJECT/) {
  
  # Should also check that the exposure times match.  Just hardwire
  # the dark-frame exposure for now.
  if ($Frm->hdr(EXPOSED) =~ /5/) {
    
    
    # generate input and output files 
    ($in,$out) = $Frm->inout('_dk');
    $dark = $Cal->dark;

    # Note all dark frames and data frames should have the same exposure time.
    # The absolute exposure times do not matter, only the relative times.
    # The output files have the same names as the input except the suffices are
    # changed to indicate they have been dark subtracted.
    $Mon{"ccdpack_red"}->obeyw("calcor","in=$in cal=$dark out=$out expose=1 reset accept");
    #
    print colored ("Orac says: $in to $out: Dark subtracted using $dark\n",'magenta');
   };
};
