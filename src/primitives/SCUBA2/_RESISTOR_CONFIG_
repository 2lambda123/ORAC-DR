# -*-cperl-*-

=head1 NAME

_RESISTOR_CONFIG_ - name of file containing alternative heater resistor values

=head1 SYNOPSIS

 _RESISTOR_CONFIG_

=head1 DESCRIPTION

This primitive checks for the existence of a specified alternative
file containing a list of alternative resistor values for the
bolometers. These resistor values are used as part of the flatfielding
process and so if specified must be included in any primitive that
calls a SMURF task which flatfields raw data.

=head1 ARGUMENTS

None.

=head1 EXTERNAL TASKS

None.

=head1 OUTPUT DATA

The Frame uhdr has a single new entry C<RECPAR_RESIST_CFG> which
either contains the name of the file containing the alternative
resistor values, or C<undef> if no file was given.

=back

=head1 OUTPUT FILES

None.

=head1 NOTES

The file must exist in C<ORAC_DATA_OUT>.

Not required for QL instances of the pipeline.

=head1 AUTHOR

Andy Gibb E<lt>agg@astro.ubc.caE<gt>

=head1 COPYRIGHT

Copyright (C) 2011 University of British Columbia. All Rights
Reserved.

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 3 of the License, or (at
your option) any later version.

This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307,
USA.

=cut

### Check if alternative resistor values have been specified
if (defined $RECPARS{RESIST_CFG}) {
  my $config;
  if (File::Spec->file_name_is_absolute( $RECPARS{RESIST_CFG} )) {
    $config = $RECPARS{RESIST_CFG};
  } else {
    $config = File::Spec->catfile($ENV{ORAC_DATA_OUT}, $RECPARS{RESIST_CFG});
  }
  # Check given file exists...
  if (-e $config) {
    orac_print "Using user-specified resistor values given in $RECPARS{RESIST_CFG}\n", "yellow";
    $Frm->uhdr("RECPAR_RESIST_CFG", $config);
  } else {
    $Frm->uhdr("RECPAR_RESIST_CFG", undef);
    orac_warn "Given resistor list, $RECPARS{RESIST_CFG}, does not exist: using default\n";
  }
}
