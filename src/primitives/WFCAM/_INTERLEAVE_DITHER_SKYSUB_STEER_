    my $do_tlevel = (defined $_INTERLEAVE_DITHER_SKYSUB_STEER_{DO_TLEVEL} ? $_INTERLEAVE_DITHER_SKYSUB_STEER_{DO_TLEVEL} : 1);
    my $tlevel = $Grp->uhdr("TLEVEL");

    # We're only allowed to do the interleaving and dithering with this recipe
    # once we have all the images for the current tile.  This is so that we
    # can use all the images available to form mean sky frames.

    if ($tlevel && $do_tlevel) {
        $Grp->uhdr("ALLOWED_TO_INTERLEAVE",$Grp->uhdr("TILE_FINISHED"));
        $Grp->uhdr("ALLOWED_TO_DITHER",$Grp->uhdr("TILE_FINISHED"));
	my $sgrp = $Grp->new;
	$sgrp->allmembers($Grp->allmembers);
	$Grp->uhdr("COMB_GROUP",$sgrp);
    } else {
	$Grp->uhdr("ALLOWED_TO_INTERLEAVE",$Grp->uhdr("JITTER_COMPLETE"));
	$Grp->uhdr("ALLOWED_TO_DITHER",$Grp->uhdr("JITTER_COMPLETE"));
	my $sgrp = $Grp->subgrp("GRPNUM"=>$Frm->hdr("GRPNUM"));
	$Grp->uhdr("COMB_GROUP",$sgrp);
    }

    # Arrays useful for storing the frame objects for superframes and dithers.

    if ($Frm->uhdr("FIRST_MEMBER_OF_CURRENT_JITTER")) {
	$Grp->uhdr("SUPERFRAMES",[]);
	@{$Grp->uhdr("SUPERFRAMES")} = ();
    }
    if ($tlevel && $Frm->uhdr("FIRST_MEMBER_OF_CURRENT_TILE")) {
	$Grp->uhdr("DITHERFRAMES",[]);
        @{$Grp->uhdr("DITHERFRAMES")} = ();
    }


=head1 NAME
 
_INTERLEAVE_DITHER_SKYSUB_STEER_ -- Set up flags defining when we are allowed
to begin combining dither and interleave sequences.  

 
=head1 DESCRIPTION
 
This is a steering primitive for the recipe INTERLEAVE_DITHER_SKYSUB. That 
particular recipe only allows for combinations to be done after all of the
frames for a particular tile have been collected.  This is because the sky
subtraction is done by combining all of the frames from the tile in order to
get a good signal-noise ratio in the mean sky frames.
 
=head1 ARGUMENTS
 
None
 
=head1 NOTES
 
Sets the following items in the $Grp->uhdr structure:

=over 4

=item ALLOWED_TO_INTERLEAVE

If set we can interleave the microstep sequences in the current tile

=item ALLOWED_TO_DITHER

If set, we can do a dither combination on each of the jitter sequences in the
current tile.

=item SUPERFRAMES

An anonymous array that is used to hold all the superframes that result from
interleaving the microstep sequences

=item DITHERFRAMES
 
An anonymous array that is used to hold all the stacked frames that result from
dithering the jitter sequences.

=head1 AUTHORS
 
JRL: Jim Lewis (CASU, IoA)
 
=head1 COPYRIGHT
 
Copyright (C) 2004-2007 Cambridge Astronomy Survey Unit.
All Rights Reserved
 
=cut

