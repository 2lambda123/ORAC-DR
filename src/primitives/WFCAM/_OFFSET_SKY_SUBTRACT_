    # Get the best offset sky available for the current frame

    my $skyfile = $Cal->sky;
    my $skyfrm = $Frm->new($skyfile);

    # Get the current frame and cycle through all of the extensions

    my $fname = $Frm->file;
    my $nextn = $Frm->findnsubs;
    foreach my $i (1 .. $nextn) {
	my $subfrm = $Frm->getasubframe($i)->file;
        my $subskyfrm = $skyfrm->getasubframe($i)->file;
	my ($retval,$errmsg);
        $retval = cir_imsubt($subfrm,$subskyfrm,$errmsg);
        if ($retval != CIR_OK) {
            orac_err("CIR_IMSUBT: Failed in _OFFSET_SKY_SUBTRACT_\n$errmsg\n");
            next;
        }
	
	# Update the header to show that the sky subtraction is
	# now done.

	my $line = sprintf("Done _OFFSET_SKY_SUBTRACT_: %s",
	    $subskyfrm);
	$retval = cir_update_hdr($subfrm,"SKYSUB","STRING",$line,
	    "",$errmsg);
    }
