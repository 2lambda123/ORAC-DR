    my $darksrc = $_DARK_SCALE_{DARKSRC};
    my $infile = $Frm->file;

    # Get the sections to be used for testing

    my ($offsect,$onsect) = $Frm->onoffsects;
    my $nsect = @$offsect;

    # Loop over the sections and work out the mean scale factor

    my $sum = 0.0;
    my $j = 0;
    for ($j = 0; $j < $nsect; $j++) {
        my ($f1,$f2,$k,@voff,@von);

	# First the 'off' sections

	$f1 = $infile . $$offsect[$j];
        $f2 = $darksrc . $$offsect[$j];
	$k = 0;
        my $errmsg;
        foreach my $ff ($f1,$f2) {
            my $retval = cir_imstat($ff,"",1,$voff[$k++],$errmsg);
            if ($retval != CIR_OK) {
                orac_throw("CIR_IMSTAT: Failed in _DARK_SCALE_ on $ff\n$errmsg\n");
            }
        }

        # Now the 'on' sections

	$f1 = $infile . $$onsect[$j];
        $f2 = $darksrc . $$onsect[$j];
	$k = 0;
        foreach my $ff ($f1,$f2) {
            my $retval = cir_imstat($ff,"",1,$von[$k++],$errmsg);
            if ($retval != CIR_OK) {
                orac_throw("CIR_IMSTAT: Failed in _DARK_SCALE_ on $ff\n$errmsg\n");
            }
        }
        $sum += ($von[0] - $voff[0])/($von[1] - $voff[1]);
    }
    $sum /= $nsect;
    $_DARK_SCALE_{SCALE} = $sum;

=head1 NAME
 
_DARK_SCALE_ -- Find the scale factor to used between an image and a dark frame
 
=head1 DESCRIPTION
                                                                               
Dark frames often need to be scaled in order that the dark correction will 
remove all of the reset anomaly properly. The primitive finds the scale 
factors required by comparing regions where the reset anomaly are large
and small and working out what scale factor would be required to set the 
mean values in all these regions to roughly equal.
 
=head1 ARGUMENTS
 
=over 4

=item DARKSRC = int (Given)

This is the dark frame image. This should have the correct image extension
appended so that it is appropriate for the image in the current $Frm object.
 
=head1 NOTES
 
=over 4
 
=item *
 
The input image is gotten from the current $Frm object.
 
=back
 
=head1 AUTHORS
 
JRL: Jim Lewis (CASU, IoA)
 
=head1 COPYRIGHT
 
Copyright (C) 2005-2008 Cambridge Astronomy Survey Unit.
All Rights Reserved
 
=cut
