=head1 NAME

_STANDARD_FILE_

=head1 DESCRIPTION

Takes a std spectrum in, files it, grows it, and files that too.

=head1 AUTHOR

Paul Hirst <p.hirst@jach.hawaii.edu>

=cut

my $in=$Grp->file;
my $base=$Grp->raw;

my $num=$Frm->group;

my $std = "std_".$num."_sp";

# Copy the spectrum to the std_ file
$Mon{'ndfpack_mon'}->obeyw("ndfcopy", "in=$in out=$std");
orac_print "$in copied to $std\n";

# Need a Frm for all this
my $spFrm = new $Frm;
$spFrm->file($std);
$spFrm->readhdr;
$spFrm->hdr("NDIMS", 1);

# Add to index
$Cal->standardindex->add($spFrm->file, $spFrm->hdr);
orac_print "$std added to standard calibration index\n";

my $ydim = $Frm->uhdr("ORAC_Y_DIM");
my $stdim = "std_".$num."_im";

# grow into an image
$Mon{'figaro1'}->obeyw("growx", "spectrum=$std image=$stdim ystart=1 yend=$ydim ysize=$ydim new=true");
orac_print "$std to $stdim: Grown into an image\n";

# Add to index
my $imFrm = new $Frm;
$imFrm->file($stdim);
$imFrm->readhdr;
$imFrm->hdr("NDIMS", 2);

$Cal->standardindex->add($imFrm->file, $imFrm->hdr);
orac_print "$stdim added to standard calibration index\n";

# File the spectrum as the current standard
$Cal->standard($spFrm->file);
orac_print "$std filed as current standard\n";

orac_print "\n";
