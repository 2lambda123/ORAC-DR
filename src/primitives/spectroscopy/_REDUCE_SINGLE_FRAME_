=head1 NAME

_REDUCE_SINGLE_FRAME_ - Carries out steps to reduce a single frame to a _wce file

=head1 DESCRIPTION

Intended to be run on all OBJECT and SKY science data, and also things
like ARC frames aswell.

Contains all the steps necessary to get from raw data to a _wce file.
Variance should be propogated throughout.

This should be the first major primitive in any recipe handling on-sky
data.

=head1 PARAMETERS

An optional NOFLAT parameter, that disables flat fielding.
This is used by the _NOFLAT recipe variants and also when
reducing a flat field frame

=head1 AUTHOR

Paul Hirst <p.hirst@jach.hawaii.edu>

=cut

_SPECTROSCOPY_HELLO_
_MASK_BAD_PIXELS_SPECT_
_ADD_READNOISE_VARIANCE_
_SUBTRACT_BIAS_
_SUBTRACT_CHOP_
_ADD_POISSON_VARIANCE_

if (!defined $_REDUCE_SINGLE_FRAME_{NOFLAT}) {
   _INTERLEAVE_COADD_
} else {
   _FLATFIELD_COADD_INTERLEAVE_
}

_WAVELENGTH_CALIBRATE_BY_ESTIMATION_
