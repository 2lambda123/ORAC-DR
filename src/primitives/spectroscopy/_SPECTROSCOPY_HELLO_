# -*-perl-*-

# Make a simple NDF if possible.
# ==============================

# Convert a one-integration HDS container file to a simple NDF with
# the _raw suffix.
    if ( $Frm->nfiles == 1 ) {
       my ( $in, $out ) = $Frm->inout( "_raw" );
       $Mon{"ndfpack_mon"}->obeyw( "ndfcopy", "in=$in out=$out" );

# Notes this uses the files plural method.  This forces the creation
# of the NDF when we supply a single NDF.
       $Frm->files( $out );
       $Frm->mergehdr;  

# This is 1x1, nexp=1. Display it as _raw (PH 2000-09-12)
       $Display->display_data( $Frm ) if ( defined $Display );
    }

# Switch history recording on.
    foreach my $frame ( $Frm->files ) {
#      $Mon{"ndfpack_mon"}->obeyw( "hisset", "ndf=$frame" );
    }

# Make sure that the Grp contains a uhdr value for NDIMS.  NDIMS is
# used by the divide-by-standard primitive to determine whether to
# divide by an image or a spectrum.  It is always 2-dimensional at the
# start.
    $Grp->uhdr( "NDIMS", 2 );

# Build the nightlog on the fly.
    _NIGHT_LOG_ OUT=1
