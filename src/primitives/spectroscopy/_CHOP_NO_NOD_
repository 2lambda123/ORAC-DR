=head1 NAME

_CHOP_NO_NOD_

=head1 DESCRIPTION


=head1 AUTHOR

Paul Hirst <p.hirst@jach.hawaii.edu>

=cut

# Just add it to the group file I guess.
my $groupfile = $Grp->raw;
my $obsnum = $Frm->number;

my ($in, $out) = $Frm->inout("_junk");

if (!($Grp->file_exists)) {
   # Create the group file by copying the file into it
   orac_print "Creating group $groupfile with $in\n";
   $Mon{'ndfpack_mon'}->obeyw("ndfcopy", "in=$in out=$groupfile title=$groupfile");
      
   # Update the group object
   $Grp->coaddspush($obsnum);
} else {
   # The group file does exist. Coadd the current file into it.
   # We use a tmp file to do the unaveraging
   my $tmp=new ORAC::TempFile;
   my $tmpfile= $tmp->file;

   my $nobs=scalar(@{ scalar($Grp->coadds) } );
   # Do the unaverage
   $Mon{'kappa_mon'}->obeyw("cmult", "in=$groupfile scalar=$nobs out=$tmpfile");

   # Use a tmp file to do the addition
   my $add=new ORAC::TempFile;
   my $addfile = $add->file;
   $Mon{'kappa_mon'}->obeyw("add", "in1=$tmpfile in2=$in out=$addfile");

   # Average back into the group file
   $nobs++;
   orac_print "$in coadded to $groupfile\n";
   orac_print "Group $groupfile now contains $nobs frames\n";
   $Mon{'kappa_mon'}->obeyw("cdiv", "in=$addfile scalar=$nobs out=$groupfile title=$groupfile");

}

# Update the Group object
$Grp->file($groupfile);

orac_print "\n";

_EXTRACT_SPECTRA_
