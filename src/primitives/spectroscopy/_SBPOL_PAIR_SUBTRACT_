
=head1 NAME

_SBPOL_PAIR_SUBTRACT_ - blah blah blah

=cut

my $main;
my $offset;
my $mFrm;

# If we're on source,
if ($Frm->uhdr("ON_SOURCE")) {
   # This is the object / main-beam frame
   $main = $Frm->file;
   $mFrm = $Frm;
   # The frame 4 ago is the offset-beam frame
   my $oFrm = ($Grp->members)[-5];
   $offset = $oFrm->file;
} else {
   # This is the offset-beam frame
   $offset = $Frm->file;
   # The frame 4 ago is the main beam frame
   my $oFrm = ($Grp->members)[-5];
   $main = $oFrm->file;
   $mFrm = $oFrm;
}

# Get the $out filename. We won't actually use $in as
# $main and $offset now hold the appropriate filenames
my $out = $mFrm->inout ("_ss");

# Do the sky subtraction
$Mon{'kappa_mon'}->obeyw("sub", "in1=$main in2=$offset out=$out title=$out");

# Update the Frm object
$Frm->file($out);

# Print message
orac_print "$offset subtracted from $main to give: $out\n";
orac_print "\n";
