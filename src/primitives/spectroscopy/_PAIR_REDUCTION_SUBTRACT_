=head1 NAME

_PAIR_REDUCTION_SUBTRACT_

=head1 DESCRIPTION

Subtracts the sky / offset beam frame from the object / main beam frame
when taking pair-wise data. 

=head1 OUTPUT

An _ss (Sky subtracted) frame for every complete pair

=head1 AUTHOR

Paul Hirst <p.hirst@jach.hawaii.edu>

=cut

my $main;
my $offset;
my $mFrm;

# If we're on source,
if ($Frm->uhdr("ON_SOURCE")) {
   # This is the object / main-beam frame
   $main = $Frm->file;
   $mFrm = $Frm;
   # The previous frame is the offset-beam frame
   my $oFrm = ($Grp->members)[-2];
   $offset = $oFrm->file;
} else {
   # This is the offset-beam frame
   $offset = $Frm->file;
   # The previous frame is the main beam frame
   my $oFrm = ($Grp->members)[-2];
   $main = $oFrm->file;
   $mFrm = $oFrm;
}

# Get the $out filename. We won't actually use $in as
# $main and $offset now hold the appropriate filenames
my ($in, $out) = $mFrm->inout ("_ss");

# Do the sky subtraction
$Mon{'kappa_mon'}->obeyw("sub", "in1=$main in2=$offset out=$out title=$out");

# Update the Frm object
$Frm->file($out);

# Print message
orac_print "$offset subtracted from $main to give: $out\n";
orac_print "\n";