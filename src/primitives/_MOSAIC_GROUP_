# _MOSAIC_GROUP_
#
# Makes a mosaic when there are sufficient object frames.
#
$isuffix = ($_MOSAIC_GROUP_{SUFFIX_IN} || "_dk");

# This should only be performed on OBJECT frames.
if (${main::Hdr}{OBSTYPE} =~ /OBJECT/) {

# Append the name of the latest object frame to the list of
# object frames.
   push (@objects, $main::File);
#   print "Number of object frames: $#objects + 1\n";
#   print "They are: @objects\n";

# Can generate a flat field and mosaic when there are at least three
# object frames (but perversely counting starts at 0).
   if ($#objects + 1 > 2 ) {
_FLAT_FIELD_ SUFFIX_IN=_dk SUFFIX_OUT=_fl
_GENERATE_OFFSETS_ SUFFIX_IN=_fl
_MAKE_MOSAIC_ SUFFIX_IN=_fl SUFFIX_OUT=mos
print "MAINROOT ",$main::Root,"\n";
#
_DISPLAY_IMAGE_ FILE=${main::Root}mos;
   };
};
