=head1 NAME

_FRAME_DIVIDE_BY_STANDARD_ 

=head1 DESCRIPTION

Asks the calibration system for a suitble standard star, and divides by it.

=head1 NOTES

The input frames should have been normalised to 1 second exposures.

=head1 AUTHOR

Paul Hirst <p.hirst@jach.hawaii.edu>
Datacube support added by Stephen Todd <spt@roe.ac.uk>

=head1 COPYRIGHT

Copyright (C) 1998-2001 Particle Physics and Astronomy Research
Council. All Rights Reserved.

=cut

if ($Frm->uhdr("PAIR_COMPLETE")) {

my $suffix;

  # Copy the group uhdr into the frame uhdr for the Cal system to see it
  my $ndims = $Frm->uhdr("NDIMS");
  #$Frm->uhdr("NDIMS", $ndims);

# Need a different name for cubes and spectra for display system.  
if($ndims == 3) {
     $suffix = "_dbsc";
  } elsif ($ndims == 2) {
     $suffix = "_dbsi";
  } else {
     $suffix = "_dbs";
  }

  my ($in, $out) = $Frm->inout($suffix);




  # Find me a standard
  my $std = $Cal->standard;
  orac_print "Standard: $std will be used\n";


  # Divide by it
  $Mon{'kappa_mon'}->obeyw("div", "in1=$in in2=$std out=$out title=$out");
  orac_print "$in to $out: Divided by standard: $std\n";

  # Update the Group object
  $Frm->file( $out );

  # Display the dbs frame
  $Display->display_data( $Frm ) if defined $Display;

  orac_print "\n";
}


