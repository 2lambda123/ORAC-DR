#+
# Name:
#    DOME_FLAT

# Purpose:
#    Process a series of dome flats to make a bad pixel mask

# Language:
#    Perl5

# Description:
#    A series of dome flats are first dark subtracted and linearity corrected.
#    Any images that are under or over exposed are removed. The rest are 
#    used to create a bad pixel mask. The routine keeps making new bad
#    pixel masks as new frames come in. The resulting frame is filed as a
#    standard bad pixel mask.

# Notes:
#    None

# Output Data:
#    - Bad pixel mask
#    - Mean dome flat 

# Configurable Steering Parameters:
#    None

# Timing:
#    {timing_information}

# Implementation Status:
#    -  The processing is all done with CIRDR routines.

# References:
#    None

# Related Recipes:
#    None

# Authors:
#    JRL: Jim Lewis (CASU)

# Copyright:
#    Copyright (C) 2005-2008 Cambridge Astronomical Survey Unit.
#    All Rights Reserved.
#
#-


# The usual startup...

_WFCAM_HELLO_

# Do dark correction

_STAGE1_ DARKCOR=1

# Linearise the frame

#_CORRECT_NONLIN_

# Do the combination and produce the bad pixel mask...

_DOME_FLAT_BPM_ MIN=1000 MAX=30000

=head1 NAME

DOME_FLAT -- Process a series of dome flats to make a bad pixel mask

=head1 DESCRIPTION

A series of dome flats are first dark subtracted and linearity corrected.
Any images that are under or over exposed are removed. The rest are 
used to create a bad pixel mask. The routine keeps making new bad
pixel masks as new frames come in. The resulting frame is filed as a
standard bad pixel mask.

=head1 NOTES

None

=head1 CONFIGURABLE STEERING PARAMETERS:

None

=head1 IMPLEMENTATION STATUS

=over 4

=item *

All processing is done with CIRDR routines.

=item *

Files are in standard Multi-extension FITS.

=back

=head1 REFERENCES

None

=head1 RELATED RECIPES

None

=head1 AUTHORS

Jim Lewis (CASU) (jrl@ast.cam.ac.uk)

=head1 COPYRIGHT

Copyright (C) 2005-2008 Cambridge Astronomical Survey Unit.
All Rights Reserved.

=cut
