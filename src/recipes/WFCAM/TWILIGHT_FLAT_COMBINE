#+
# Name:
#    TWILIGHT_FLAT_COMBINE

# Purpose:
#     Combine twilight WFCAM flat field data and form a mean flat

# Language:
#    Perl5

# Description:
#    This recipe combines WFCAM twilight flat field files into a mean flat.
#

# Notes:
#    None
#

# Output Data:
#    -  A mean flat field and initial confidence map.

# Configurable Steering Parameters:
#    none

# Timing:
#    {timing_information}

# Implementation Status:
#    -  The processing is all done with CIRDR routines.

# References:
#    none

# Related Recipes:
#    none

# Authors:
#    JRL: Jim Lewis (CASU)
#
# Copyright:
#    Copyright (C) 2004-2007 Cambridge Astronomical Survey Unit.
#    All Rights Reserved.
#
#-

# Startup

_WFCAM_HELLO_

# Do the dark correction

_STAGE1_ DARKCOR=1

# Weed out the frames that aren't in the right data range...

_WEED_OUT_ MIN=8000 MAX=20000
return if (! $Frm->isgood);

# Linearise the frame

#_CORRECT_NONLIN_

# Do the combination.  Spew out a mean flat and an initial confidence map

_TWILIGHT_FLAT_COMBINE_

=head1 NAME

TWILIGHT_FLAT_COMBINE

=head1 DESCRIPTION

This recipe takes flat field exposures and creates a mean flat and initial
confidence map.  

=head1 NOTES

=over 4

=item *

None

=back

=head1 OUTPUT DATA

=over 4

=item *

A mean flat field and an initial confidence map.

=back

=head1 CONFIGURABLE STEERING PARAMETERS

=over 4

=item none

=back

=head1 IMPLEMENTATION STATUS

=over 4

=item *

All processing is done with CIRDR routines.

=item *

Files are in standard Multi-extension FITS.

=back

=head1 REFERENCES

none

=head1 RELATED RECIPES

none

=head1 AUTHORS

Jim Lewis (CASU) (jrl@ast.cam.ac.uk)

=head1 COPYRIGHT

Copyright (C) 2004-2007 Cambridge Astronomical Survey Unit. 
All Rights Reserved.

=cut
