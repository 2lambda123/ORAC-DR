#+
# Name:
#    LINEARITY_CURVE

# Purpose:
#    Create a linearity curve for each data channel from a series of dome flats

# Language:
#    Perl5

# Description:
#    This recipe creates a linearity curve for each data channel:
#       - Each frame is first dark corrected
#       - Over and underexposed frames are rejected from further consideration
#       - The remaining frames are used to create a linearity curve for each
#         data channel in the detector
#

# Notes:
#    None
#

# Output Data:
#    -  A linearity table for the detector

# Configurable Steering Parameters:
#    None

# Timing:
#    {timing_information}

# Implementation Status:
#    -  The processing is all done with CIRDR routines.

# References:
#    None

# Related Recipes:
#    None

# Authors:
#    JRL: Jim Lewis (CASU)
#

# Copyright:
#    Copyright (C) 2005-2008 Cambridge Astronomical Survey Unit.
#    All Rights Reserved.
#
#-

# Get started

_WFCAM_HELLO_

# Subtract a dark frame

_STAGE1_ DARKCOR=1

# Ditch any frame where the flux is either too low or too high

_WEED_OUT_ MIN=500 MAX=40000
return if (! $Frm->isgood);

# Do the linearity curve...

_LINEARITY_CURVE_

=head1 NAME

LINEARITY_CURVE --  Create a linearity curve for each data channel from a 
series of dome flats

=head1 DESCRIPTION

This recipe creates a linearity curve for each data channel:

=over 4

=item *

Each frame is first dark corrected

=item *

Over and underexposed frames are rejected from further consideration

=item *

The remaining frames are used to create a linearity curve for each data channel
in the detector

=back

=head1 NOTES

None

=head1 OUTPUT DATA

=over 4

=item *

A linearity table for the detector

=back

=head1 CONFIGURABLE STEERING PARAMETERS

None

=head1 IMPLEMENTATION STATUS

=over 4

=item *

All processing is done with CIRDR routines.

=item *

Files are in standard Multi-extension FITS.

=back

=head1 REFERENCES

None

=head1 RELATED RECIPES

None

=head1 AUTHORS

Jim Lewis (CASU) (jrl@ast.cam.ac.uk)

=head1 COPYRIGHT

Copyright (C) 2005-2008 Cambridge Astronomical Survey Unit.
All Rights Reserved.

=cut
