#+
# Name:
#    TEST_WFCAM_CIRSI

# Purpose:
#    Test pipeline for dummy WFCAM data.  

# Language:
#    Perl5

# Description:
#    This recipe does a reduction for dummy WFCAM frames.  These consist
#    of WFCAM frame headers with CIRSI images appended. At the moment the
#    recipe does a flat field correction, sky subtraction, reset anomaly
#    removal, rough WCS assignment, dither and WCS fit.  More stuff to be
#    added at a later date
#
# Notes:
#    -  This is not intended to be a first pass WFCAM pipeline and only is
#       intended for a particular dataset.
#
# Output Data:
#    -  Instrumental signature removed images and dithers. All have at
#       at least a first pass WCS.

# Configurable Steering Parameters:
#    none

# Timing:
#    {timing_information}

# Implementation Status:
#    -  The processing is all done with CIRDR routines.

# References:
#    none

# Related Recipes:
#    none

# Authors:
#    JRL: Jim Lewis (CASU)
#
# Copyright:
#    Copyright (C) 2003-2006 Cambridge Astronomical Survey Unit.
#    All Rights Reserved.
#
#-

# Startup

_WFCAM_HELLO_
_TEST_WFCAM_CIRSI_STEER_

# Give each frame a rough WCS based on image headers and known geometry of 
# the camera

_ROUGHWCS_

# Do stage 1 processing.  In this recipe it's just a flat field correction

_STAGE1_ FLATCOR=1

# Create a sky frame from each dither sequence.  Scale and subtract it

_JITTER_SKY_

# Do a reset anomaly correction

_TARTUP_

# Dither the individual frames into one dither frame.

_DITHER_

# Fit a WCS to the dither frame.  Use the dither offsets to refer the WCS 
# solution back to the original frames

_WCSFIT_ CATSRC=usno PASS=1

# Process the history keywords in the file headers.

_PROCHIST_

=head1 NAME

TEST_WFCAM_CIRSI

=head1 DESCRIPTION

This recipe flat fields, sky subtracts, reset anomaly corrects, dithers and
fits a WCS to dummy WFCAM data. It expects a flat field image to be present.

=head1 NOTES

=over 4

=item *

This is B<not> a first pass WFCAM pipeline.  It's intended only for use in
defining some of the WFCAM class files and for testing an installation 
of CIRDR. If you want to use this, you'll need to get the test dataset.

=back

=head1 OUTPUT DATA

=over 4

=item *

Instrumental signature free images and dithers.

=back

=head1 CONFIGURABLE STEERING PARAMETERS

=over 4

=item none

=back

=head1 IMPLEMENTATION STATUS

=over 4

=item *

All processing is done with CIRDR routines.

=item *

Files are in standard Multi-extension FITS.

=back

=head1 REFERENCES

none

=head1 RELATED RECIPES

none -- this is a 'one off'.

=head1 AUTHORS

Jim Lewis (CASU) (jrl@ast.cam.ac.uk)

=head1 COPYRIGHT

Copyright (C) 2003-2006 Cambridge Astronomical Survey Unit. 
All Rights Reserved.

=cut
