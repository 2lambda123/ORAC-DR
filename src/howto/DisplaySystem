=pod

=head1 The ORAC-DR Display System - an ORAC-DR HOWTO

=head2 Description

The ORAC-DR pipeline has a highly configurable display engine. This
note describes how it works and how to use it.

=head2 The disp.dat file

The actual display engine is configured via an ASCII file called
disp.dat. A default disp.dat file exists in the general oracdr
distribution (ORAC_DIR). Additionally a default disp.dat is provided
by your instrument scientist or software engineer in the appropriate
calibration directory (ORAC_DATA_CAL)

When you invoke oracdr, the pipeline checks in ORAC_DATA_OUT for an
existing disp.dat. If it does not find one, it copies in the one from
ORAC_DATA_CAL, or if that doesn't exist, the one from ORAC_DIR. In
all of those scenarios you end up with a file in ORAC_DATA_OUT which
is what is used by the display system. Any configuration changes have
to be reflected in the file.

=head2 How to change the disp.dat file

As it is an ASCII file, you may edit the file directly in your
favourite editor. However a much easier approach is to type use the
oracdisp GUI (simply type oracdisp). This has various options
available at the top and shows the disp.dat entries corresponding to
those choices at the bottom. Don't forget to write press the
"Configure" button to write the file to disk. 

You may use oracdisp (or the editor) to change the display parameters
while the pipeline is running.

=head2 How the pipeline displays

The disp.dat file has a series of entries consisting of a line
each. Each line has a series of space-separated items.

These items are:

=over 4

=item suffix

A file suffix representing a particular step of the data reduction
process as designated by that instrument's file naming convention. For
example, for UFTI data "dk" states what to do with a file called
f19990330_00042_dk.sdf . Many entries may be made for a particular
suffix. The following special conventions are used: NUM describes a
file ending in just an observation number (usually representing raw
data). For instruments that have multiple data arrays in a single data
frame, S2<suffix> (eg. S2dk) represents the second data array in the
frame with the _dk suffix.

=item type

A display type such as graph, image, contour etc. These vary according 
to the tool selected. To find out the display types supported via
ORAC-DR in a given tool, type oracman <tool>, eg oracman KAPVIEW.

=item tool

A display tool such as Gaia or Kapview (the latter being a collective
term for various KAPPA display tasks). The tools available are
determined by the display type selected.

=item display attributes

A series of value-attribute pairs depending on the display type eg.
plotting limits, number of bins etc.

=item window

The number of the window in which the display is to go. The value of
this is simply an identifier and does not presuppose order. If you ask 
for an image display to go to window 2 and you have configured no
displays to go to windows 0 and 1 then you will only get one window on 
your screen. If you then configure a histogram display to go to window 
2 it will go to the same window whereas if you configure it to go to
window 1 (or 5 or 9 or anything else besides 2) it will end up in its
own window. Note that no windows are launched until they are
required.

=item region

For device tools that support it, region addresses the parts of a
window where a display ends up. For Kapview, these are: whole screen
(0), top left quarter (1), top right quarter (2), bottom left quarter
(3), bottom right quarter (4), left half (5), left right (6), top half 
(7), bottom half (8).

=back

=head2 The order of play

Every time a primitive creates a meaningful file with a particular
suffix, it sends a display request to the display system. For example, 
suppose the primitive that performs dark subtraction creates a frame
called f19990330_00042_dk.sdf and then asks the display system to
display it. The display system consults the disp.dat file for a dk
entry. If no such entry is found, the display request is ignored and
nothing happens. If one or more entries are found the display system
proceeds to honour the request. If the disp.dat entry specifies a
particular tool and/or window, the display system checks to see if
they exist already and if not, stars them. Then it displays the data
with the appropriate parameters.

=head1 Document info

Original author: frossie

$Id$

=cut






